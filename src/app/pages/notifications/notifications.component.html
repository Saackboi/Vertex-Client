<!-- Main Content -->
<!-- Header -->
<header class="notifications-header">
  <div class="header-container">
    <!-- Logo -->
    <app-logo route="/dashboard" />

    <!-- Navigation -->
    <div class="nav-section">
      <nav class="nav-links">
        <a (click)="navigateToProfile()">Perfil</a>
        <a class="active">Notificaciones</a>
      </nav>

      <div class="action-buttons">
        <button class="icon-button" (click)="toggleDarkMode()">
          <span nz-icon [nzType]="isDarkMode ? 'sun' : 'moon'" nzTheme="outline"></span>
        </button>
        <button class="icon-button">
          <nz-badge [nzCount]="(unreadCount$ | async) || 0">
            <span nz-icon nzType="bell" nzTheme="outline"></span>
          </nz-badge>
        </button>
        <nz-avatar 
          nz-dropdown 
          [nzDropdownMenu]="userMenu" 
          nzPlacement="bottomRight"
          nzIcon="user" 
          [nzSize]="32"
          class="user-avatar">
        </nz-avatar>
        <nz-dropdown-menu #userMenu="nzDropdownMenu">
          <ul nz-menu>
            <li nz-menu-item (click)="navigateToProfile()">
              <span nz-icon nzType="user" nzTheme="outline"></span>
              Mi Perfil
            </li>
            <li nz-menu-divider></li>
            <li nz-menu-item (click)="logout()">
              <span nz-icon nzType="logout" nzTheme="outline"></span>
              Cerrar Sesión
            </li>
          </ul>
        </nz-dropdown-menu>
      </div>
    </div>
  </div>
</header>

<!-- Main Content -->
<main class="notifications-main">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-left">
      <button class="back-button" (click)="goBack()">
        <span nz-icon nzType="arrow-left" nzTheme="outline"></span>
      </button>
      <h1 class="page-title">Notificaciones</h1>
    </div>
    @if ((unreadCount$ | async) ?? 0 > 0) {
      <div class="unread-badge">
        {{ (unreadCount$ | async) ?? 0 }} sin leer
      </div>
    }
    @if ((unreadCount$ | async) ?? 0 > 0) {
      <button class="mark-all-read-button" (click)="markAllAsRead()">
        Marcar todas como leídas
      </button>
    }
  </div>

  <!-- Notifications List -->
  <div class="notifications-container">
    @if ((notifications$ | async)?.length === 0) {
      <div class="empty-state">
        <span nz-icon nzType="bell" nzTheme="outline"></span>
        <h3>No hay notificaciones</h3>
        <p>Cuando tengas notificaciones, aparecerán aquí</p>
      </div>
    } @else {
      @for (notification of (notifications$ | async); track notification.id) {
        <div [class]="'notification-card ' + (notification.read ? 'read' : 'unread')">
          <div class="notification-icon" [class]="notification.type">
            @if (notification.type === 'success') {
              <span nz-icon nzType="check-circle" nzTheme="outline"></span>
            } @else if (notification.type === 'warning') {
              <span nz-icon nzType="exclamation-circle" nzTheme="outline"></span>
            } @else if (notification.type === 'error') {
              <span nz-icon nzType="close-circle" nzTheme="outline"></span>
            } @else {
              <span nz-icon nzType="info-circle" nzTheme="outline"></span>
            }
          </div>
          <div class="notification-content">
            <h3 class="notification-title">{{ notification.title }}</h3>
            <p class="notification-message">{{ notification.message }}</p>
            <span class="notification-time">{{ notification.timestamp }}</span>
          </div>
          <div class="notification-actions">
            @if (!notification.read) {
              <button class="action-button mark-read" (click)="markAsRead(notification.id)">
                <span nz-icon nzType="check" nzTheme="outline"></span>
              </button>
            }
<!--             <button class="action-button delete" (click)="deleteNotification(notification.id)">
              <span nz-icon nzType="delete" nzTheme="outline"></span>
            </button> -->
          </div>
        </div>
      }
    }
  </div>
</main>

<app-footer />
